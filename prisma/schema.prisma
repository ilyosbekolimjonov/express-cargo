generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id             Int        @id @default(autoincrement())
  full_name      String
  email          String     @unique
  password_hash  String
  phone_number   String?
  roles          USER_ROLES @default(CUSTOMER)

  orders         Order[]    // 1:M â€“ foydalanuvchining buyurtmalari
}

model Status {
  id          Int      @id @default(autoincrement())
  name        String
  description String?

  orders      Order[]
}

model Order {
  id               Int           @id @default(autoincrement())
  order_unique_id  String        @default(uuid())
  user_id          Int
  delivery_address String?
  current_status_id Int?

  user          User           @relation(fields: [user_id], references: [id])
  currentStatus Status?        @relation(fields: [current_status_id], references: [id])
  items         OrderItem[]    // 1:M

  createdAt     DateTime       @default(now())
}

model OrderItem {
  id              Int           @id @default(autoincrement())
  order_id        Int
  product_link    String
  quantity        Int
  currency_type_id Int

  order        Order         @relation(fields: [order_id], references: [id])
  currencyType Currency_type @relation(fields: [currency_type_id], references: [id])
}

model Currency_type {
  id          Int          @id @default(autoincrement())
  name        String
  description String?
  orderItems  OrderItem[]  // 1:M
}

enum USER_ROLES {
  ADMIN
  DELIVERY_STAFF
  CUSTOMER
}